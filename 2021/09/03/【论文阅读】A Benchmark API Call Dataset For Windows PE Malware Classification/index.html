<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  
  <title>A Benchmark API Call Dataset For Windows PE Malware Classification | Shaw</title>
  <meta name="author" content="Shaw">
  
  <meta name="description" content="随想随录">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="A Benchmark API Call Dataset For Windows PE Malware Classification"/>
  <meta property="og:site_name" content="Shaw"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Shaw</a></h1>
  <h2><a href="/">@hust</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-【论文阅读】A Benchmark API Call Dataset For Windows PE Malware Classification" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-09-03T06:08:27.096Z"><a href="/2021/09/03/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E3%80%91A%20Benchmark%20API%20Call%20Dataset%20For%20Windows%20PE%20Malware%20Classification/">2021-09-03</a></time>
      
      
  
    <h1 class="p-name title" itemprop="headline name">A Benchmark API Call Dataset For Windows PE Malware Classification</h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="【论文阅读】A-Benchmark-API-Call-Dataset-For-Windows-PE-Malware-Classification"><a href="#【论文阅读】A-Benchmark-API-Call-Dataset-For-Windows-PE-Malware-Classification" class="headerlink" title="【论文阅读】A Benchmark API Call Dataset For Windows PE Malware Classification"></a>【论文阅读】A Benchmark API Call Dataset For Windows PE Malware Classification</h1><blockquote>
<p><strong>作者：Ferhat Ozgur Catak（土耳其）</strong></p>
<p>​            <strong>Ahmet Faruk Yazi（土耳其）</strong></p>
<p><strong>时间：2021.2.23</strong></p>
<p><strong>关键词：恶意软件分析，网络空间安全，数据集，沙箱环境，恶意软件分类</strong></p>
</blockquote>
<h3 id="1-Abstract"><a href="#1-Abstract" class="headerlink" title="1. Abstract"></a>1. Abstract</h3><p>​    在Windows操作系统中，系统API调用的使用在监控恶意PE程序中是一个很有前途的方法。这个方法被定义为在安全隔离的沙箱环境中运行恶意软件，记录其调用的Windows系统API，再顺序分析这些调用。<br>​    在这里，我们在隔离沙箱中分析了7107个属于不同家族（病毒，后门，木马等）的恶意软件，并把这些分析结果转化为了不同分类算法和方法可以使用的形式。<br>​    <strong>首先</strong>，我们会解释如何得到这些恶意软件；<strong>其次</strong>，我们会解释如何将这些软件捆绑至家族中；<strong>最后，</strong>我们会描述如何使用这些数据集来通过不同的方法实现恶意软件的分类。</p>
<hr>
<h3 id="2-Introduction"><a href="#2-Introduction" class="headerlink" title="2. Introduction"></a>2. Introduction</h3><h4 id="2-1-简单介绍了恶意软件"><a href="#2-1-简单介绍了恶意软件" class="headerlink" title="2.1 简单介绍了恶意软件"></a>2.1 简单介绍了恶意软件</h4><h4 id="2-2-恶意软件与恶意软件识别之间的竞争"><a href="#2-2-恶意软件与恶意软件识别之间的竞争" class="headerlink" title="2.2 恶意软件与恶意软件识别之间的竞争"></a>2.2 恶意软件与恶意软件识别之间的竞争</h4><p>​    相互促进</p>
<h4 id="2-3-变形恶意软件（Metamorphic-malware）"><a href="#2-3-变形恶意软件（Metamorphic-malware）" class="headerlink" title="2.3 变形恶意软件（Metamorphic malware）"></a>2.3 变形恶意软件（Metamorphic malware）</h4><p>​        恶意软件家族里很先进的一种，这种软件可以持续不断的改变自身源代码以此改变自身结构，通过这种方式来改变自身代码特征。还有，这种软件可能还可以通过强度反算（counter-analysis）来识别自身运行的环境，以此来隐藏自身的恶意功能。</p>
<p>​        变形恶意软件很难识别。</p>
<h4 id="2-4-恶意软件的识别："><a href="#2-4-恶意软件的识别：" class="headerlink" title="2.4 恶意软件的识别："></a>2.4 恶意软件的识别：</h4><p>​        所有恶意软件都会有恶意行为以达成其目的，如果可以很好的分析恶意行为，就可以做成恶意软件的识别与分类。<br>​        恶意软件的识别包括了很多需要解决的问题，例如在汇编中不正确的跳转操作码，PE文本段代码隐藏，代码加密。本研究收集了现有的恶意软件及其变式，例如WannaCry，Zeus，特别是在Github上。</p>
<p>​        我们通过在VirusTotal网站上寻找每个恶意软件的哈希值，从而获得了得到了其家族类。</p>
<p>​        最后，所有我们记录的行为都是在Cuckoo沙盒环境中运行的。</p>
<p>​        我们发现几乎所有恶意软件都会使用很多方法改变其行为，但即使这样，恶意软件还是有一个目标，有一个确定的模式来达到此目标。还有，恶意软件会做出一些不必要的API调用，但其还是可以被一个训练好的分析器识别，因为其行为模式是相同的。</p>
<p>​        恶意软件分析被视为网络空间安全的一个分支，其由两方面组成：</p>
<h5 id="1-静态分析-："><a href="#1-静态分析-：" class="headerlink" title="1. 静态分析 ："></a><strong>1. 静态分析 </strong>：</h5><p>​                静态分析可以可以定义为通过执行一个孤立的环境检查可执行文件而不查看实际指令。例如MD5校验和，其通过反病毒检测攻击识别，查找字符串。</p>
<h5 id="2-动态分析"><a href="#2-动态分析" class="headerlink" title="2. 动态分析"></a>2. 动态分析</h5><p>​                动态分析指运行恶意程序来理解其功能，观察其表现，识别其技术指标。几乎所有的重要行为都包含API调用序列。</p>
<p>​        <strong>大多数动态分析领域的研究都只关注分类算法，有个基本问题是没有标准的数据集来检查所提出模型的效率。</strong></p>
<p>​        <strong>我们在Github上分享了我们的数据集：<a target="_blank" rel="noopener" href="https://github.com/ocatak/malware_api_class">https://github.com/ocatak/malware_api_class</a> ，该数据集包含了基于Cuckoo沙箱的已知恶意软件执行和基于VirusTotal的文件MD5特征分类的原始数据。</strong></p>
<hr>
<h3 id="3-Methods"><a href="#3-Methods" class="headerlink" title="3. Methods"></a>3. Methods</h3><h4 id="3-1-Windows-API-Calls："><a href="#3-1-Windows-API-Calls：" class="headerlink" title="3.1 Windows API Calls："></a>3.1 Windows API Calls：</h4><p>​    软件安全知识，略</p>
<h4 id="3-2-Cuckoo-SandBox"><a href="#3-2-Cuckoo-SandBox" class="headerlink" title="3.2 Cuckoo SandBox"></a>3.2 Cuckoo SandBox</h4><p>​    免费软件，高度集成，开源，可以自动分析Winodws,OS X,Linux,Android系统下的恶意文件。</p>
<h4 id="3-3-VirusTotal"><a href="#3-3-VirusTotal" class="headerlink" title="3.3 VirusTotal"></a>3.3 VirusTotal</h4><p>​    可以在线免费分析文件或者URL。其提供了一个API，可以不通过浏览器来提供分析结果，可以自动分析。其以JSON文件的形式提供分析结果，不同反病毒应用引擎和浏览器的分析结果会分开存放。</p>
<h4 id="3-4-数据集生成"><a href="#3-4-数据集生成" class="headerlink" title="3.4 数据集生成"></a>3.4 数据集生成</h4><p>​    本文的数据集有着简单明了的结构。数据集以CVS格式文件提供来提高互操作性，而且并不需要特定的软件或者库来读取他们。数据由来自不同Github页面的Git命令实施收集，数据集中的每一行都是在沙箱中分析的Windows操作系统的API调用序列。</p>
<p>​    数据集的生成过程如下：</p>
<p>​    <strong>1. 沙箱环境准备：</strong></p>
<p>​    分析机器使用Ubuntu系统，将Cuckoo沙箱安装在其中，分析机运行虚拟服务，Windows操作系统就运行在虚拟服务上，同时关掉防火墙，系统升级。</p>
<p>​    <strong>2. 分析恶意软件:</strong></p>
<p>​    虚拟机中同时运行超过20000个恶意软件，应用程序会将每个恶意软件的分析结果写入MongoDB数据库，分析结果中包含恶意软件的行为数据，这些数据都是恶意软件在Win7上的API调用请求。</p>
<p>​    <strong>3. 处理API调用：</strong></p>
<p>​    我们在数据集中收集到了342种API调用，这些调用会被以0-341来标记，以此生成一个新数据集。我们使用了该数据集中至少有10个不同API调用的恶意软件的分析结果。</p>
<p>​    <strong>4. 使用Virus Total公用API分析恶意软件：</strong></p>
<p>​    作为分析的补充，所有在数据集中的恶意软件也会被Virus Total所分析，通过这种方式，每个恶意软件都会被不同的反病毒引擎所分析，结果会被记录。</p>
<p>​    <strong>5. 处理分析结果：</strong></p>
<p>​    Virus Total服务使用大约66个不同的防病毒应用程序进行文件分析。利用我们利用这个服务得到的每个研究结果，我们识别了每个恶意软件的家族。通过观察，我们发现对于同一恶意软件，不同的防病毒应用程序给出了不同的结果。此外，观察到并非每一个防病毒应用程序都能检测到一些恶意软件。因此，在检测每一个恶意软件类时，认为它属于所有分析中的大多数类。</p>
<p><img src="http://shaw-typora.oss-cn-beijing.aliyuncs.com/20210716172418.png" alt=""></p>
<p><img src="http://shaw-typora.oss-cn-beijing.aliyuncs.com/20210716172518.png" alt=""></p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Paper/">Paper</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Malware-Classifiers/">Malware Classifiers</a>, <a href="/tags/AD/">AD</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://example.com/2021/09/03/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E3%80%91A%20Benchmark%20API%20Call%20Dataset%20For%20Windows%20PE%20Malware%20Classification/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="as_sitesearch" value="example.com">
  </form>
</div>


  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Book/">Book</a><small>1</small></li>
  
    <li><a href="/categories/CSP/">CSP</a><small>15</small></li>
  
    <li><a href="/categories/LQB/">LQB</a><small>3</small></li>
  
    <li><a href="/categories/Paper/">Paper</a><small>16</small></li>
  
    <li><a href="/categories/Something/">Something</a><small>3</small></li>
  
    <li><a href="/categories/%E2%97%8F%E8%AF%BE%E5%86%85/">●	课内</a><small>2</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/AD/">AD</a><small>10</small></li>
  
    <li><a href="/tags/AD-training/">AD training</a><small>1</small></li>
  
    <li><a href="/tags/Android/">Android</a><small>1</small></li>
  
    <li><a href="/tags/Botnet/">Botnet</a><small>1</small></li>
  
    <li><a href="/tags/DDoS/">DDoS</a><small>1</small></li>
  
    <li><a href="/tags/DNN/">DNN</a><small>1</small></li>
  
    <li><a href="/tags/IDS/">IDS</a><small>2</small></li>
  
    <li><a href="/tags/Machine-Learning/">Machine Learning</a><small>2</small></li>
  
    <li><a href="/tags/Malware-Classifiers/">Malware Classifiers</a><small>5</small></li>
  
    <li><a href="/tags/Math/">Math</a><small>1</small></li>
  
    <li><a href="/tags/Mutiagent/">Mutiagent</a><small>1</small></li>
  
    <li><a href="/tags/NLP/">NLP</a><small>3</small></li>
  
    <li><a href="/tags/PDF/">PDF</a><small>1</small></li>
  
    <li><a href="/tags/RL/">RL</a><small>3</small></li>
  
    <li><a href="/tags/RNN/">RNN</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2022 Shaw
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script>
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
